<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¨ì–´ í…ŒìŠ¤íŠ¸ì§€ ìƒì„± ë° ì¶œë ¥</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            padding: 20px;
        }

        /* 1. ì„¤ì • í™”ë©´ ìŠ¤íƒ€ì¼ */
        #settings-view {
            max-width: 768px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }

        /* 2. ì¶œë ¥ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #print-view {
            display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
            width: 210mm; /* A4 ìš©ì§€ ë„ˆë¹„ */
            min-height: 297mm; /* A4 ìš©ì§€ ë†’ì´ */
            margin: 0 auto;
            background: white;
            padding: 20mm 15mm;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .sheet-header {
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
            margin-bottom: 20px;
        }

        .word-item {
            display: flex;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .word-item-index {
            width: 30px;
            flex-shrink: 0;
            font-weight: 600;
        }
        .word-item-prompt {
            flex-grow: 1;
            padding-right: 10px;
            border-bottom: 1px dashed #bbb;
        }

        .word-item-answer {
            flex-grow: 2;
            padding-left: 10px;
            border-bottom: 1px solid #333; /* ì •ë‹µì§€ìš© */
        }
        
        /* ì±•í„° ì„ íƒ ê·¸ë¦¬ë“œ */
        #chapter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: 8px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        /* ì¸ì‡„ ì‹œ ìŠ¤íƒ€ì¼ (ê°€ì¥ ì¤‘ìš”) */
        @media print {
            body {
                background: white;
                margin: 0;
                padding: 0;
            }
            #settings-view, #control-buttons, .back-to-settings, #error-message {
                display: none !important;
            }
            #print-view {
                display: block !important;
                width: 100%;
                min-height: auto;
                margin: 0;
                padding: 15mm 10mm; /* ì¸ì‡„ ì—¬ë°± ì¡°ì • */
                box-shadow: none;
            }
            /* A4 ìš©ì§€ 1í˜ì´ì§€ì— ë§ì¶”ê¸° ìœ„í•œ ë¶„í•  ë°©ì§€ */
            .page-break {
                page-break-before: always;
            }
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>

    <div id="settings-view" class="space-y-6">
        <h1 class="text-3xl font-bold text-center text-indigo-700">ğŸ“ ë‹¨ì–´ í…ŒìŠ¤íŠ¸ì§€ ì„¤ì •</h1>

        <!-- ì±•í„° ì„ íƒ -->
        <div class="space-y-2">
            <label class="block text-lg font-semibold text-gray-700">1. Chapter ì„ íƒ (ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)</label>
            <div id="chapter-grid">
                <!-- Chapter ì²´í¬ë°•ìŠ¤ê°€ ì—¬ê¸°ì— JSë¡œ ìƒì„±ë¨ -->
            </div>
        </div>

        <!-- ë¬¸í•­ ìˆ˜, ë‹¨ì–´ ìœ í˜• ì„ íƒ -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
                <label for="question-count" class="block text-lg font-semibold text-gray-700">2. ì›í•˜ëŠ” ë¬¸í•­ ìˆ˜</label>
                <input type="number" id="question-count" value="30" min="5" max="300" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
            </div>

            <div class="space-y-2">
                <label class="block text-lg font-semibold text-gray-700">3. ë‹¨ì–´ ìœ í˜• ì„ íƒ</label>
                <select id="word-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="í‘œì œì–´">í‘œì œì–´ë§Œ í…ŒìŠ¤íŠ¸</option>
                    <option value="all">í‘œì œì–´ + ì—°ê´€ì–´ ëª¨ë‘ í…ŒìŠ¤íŠ¸</option>
                </select>
            </div>
        </div>
        
        <!-- í…ŒìŠ¤íŠ¸ ë°©í–¥ ì„ íƒ -->
        <div class="space-y-2">
            <label class="block text-lg font-semibold text-gray-700">4. í…ŒìŠ¤íŠ¸ ë°©í–¥ ì„ íƒ</label>
            <select id="test-direction" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                <option value="en_to_ko">ì˜ì–´ ì œì‹œ â†’ í•œê¸€ ëœ» ì ê¸°</option>
                <option value="ko_to_en">í•œê¸€ ëœ» ì œì‹œ â†’ ì˜ì–´ ë‹¨ì–´ ì ê¸°</option>
            </select>
        </div>

        <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
        <div id="error-message" class="hidden p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>

        <!-- ë²„íŠ¼ -->
        <div class="pt-4">
            <button id="generate-btn" class="w-full py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition duration-150 shadow-md">
                í…ŒìŠ¤íŠ¸ì§€ ìƒì„± ë° ì¶œë ¥ ì¤€ë¹„
            </button>
        </div>
    </div>

    <!-- 2. í…ŒìŠ¤íŠ¸ì§€ ì¶œë ¥ í™”ë©´ -->
    <div id="print-view" class="hidden">
        
        <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ (ì¸ì‡„ ì‹œ ìˆ¨ê¹€) -->
        <div id="control-buttons" class="no-print fixed top-4 right-4 space-x-3">
            <button id="print-sheet-btn" class="py-2 px-4 bg-green-500 text-white rounded-lg hover:bg-green-600">
                ğŸ–¨ï¸ í…ŒìŠ¤íŠ¸ì§€ & ì •ë‹µì§€ ì¸ì‡„
            </button>
            <button id="back-to-settings" class="py-2 px-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                ì„¤ì •ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </button>
        </div>
        
        <!-- í…ŒìŠ¤íŠ¸ì§€ ì˜ì—­ -->
        <div id="test-sheet-container">
            <!-- í…ŒìŠ¤íŠ¸ì§€ ë‚´ìš©ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤. -->
        </div>

        <!-- ì •ë‹µì§€ ì˜ì—­ -->
        <div id="answer-sheet-container" class="page-break">
            <!-- ì •ë‹µì§€ ë‚´ìš©ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤. -->
        </div>

    </div>

    <script>
        // ì´ ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ì´ script.js ì—­í• ì„ í•©ë‹ˆë‹¤.
        
        // 1. ì‚¬ìš©ì CSV ë°ì´í„° ì •ì˜ (ì²¨ë¶€ëœ íŒŒì¼ì˜ ì „ì²´ ë‚´ìš©)
        // [Chapter, Type, Word, Meaning]
        const rawCSVData = [
            [30, 'í‘œì œì–´', 'abandon', "v.ë²„ë¦¬ë‹¤, í¬ê¸°í•˜ë‹¤"],
            [20, 'í‘œì œì–´', 'ability', "n.ëŠ¥ë ¥, ì¬ëŠ¥"],
            [2, 'í‘œì œì–´', 'abolish', "v.íì§€í•˜ë‹¤, ì—†ì• ë‹¤"],
            [25, 'í‘œì œì–´', 'abroad', "ad.í•´ì™¸ë¡œ"],
            [26, 'í‘œì œì–´', 'absence', "n.ë¶€ì¬, ê²°ì„, ê²°ê·¼"],
            [26, 'ì—°ê´€ì–´', 'absent', "a.ê²°ì„í•œ, ì—†ëŠ”"],
            [42, 'í‘œì œì–´', 'absolute', "a.ì ˆëŒ€ì ì¸, ì™„ì „í•œ"],
            [42, 'ì—°ê´€ì–´', 'absolutely', "ad.ì™„ì „íˆ, ì „ì ìœ¼ë¡œ"],
            [47, 'í‘œì œì–´', 'absorb', "v.í¡ìˆ˜í•˜ë‹¤, (ì •ë³´ë¥¼) ë°›ì•„ë“¤ì´ë‹¤"],
            [47, 'ì—°ê´€ì–´', 'absorption', "n.í¡ìˆ˜, í†µí•©, ëª°ë‘"],
            [4, 'í‘œì œì–´', 'abstract', "a.ì¶”ìƒì ì¸"],
            [4, 'ì—°ê´€ì–´', 'abstraction', "n.ì¶”ìƒ, ê´€ë…"],
            [17, 'í‘œì œì–´', 'abundant', "a.í’ë¶€í•œ, í’ì¡±í•œ"],
            [17, 'ì—°ê´€ì–´', 'abundance', "n.í’ë¶€, í’ìš”"],
            [34, 'í‘œì œì–´', 'abuse', "v.ë‚¨ìš©í•˜ë‹¤, ì˜¤ìš©í•˜ë‹¤ n.ë‚¨ìš©, ì˜¤ìš©"],
            [34, 'ì—°ê´€ì–´', 'abusive', "a.í•™ëŒ€í•˜ëŠ”"],
            [28, 'í‘œì œì–´', 'academic', "a.í•™ì—…ì˜, í•™ë¬¸ì˜  n.í•™ì"],
            [28, 'ì—°ê´€ì–´', 'academically', "ad.í•™ë¬¸ì ìœ¼ë¡œ"],
            [13, 'í‘œì œì–´', 'accelerate', "v.ê°€ì†í•˜ë‹¤, ë¹¨ë¼ì§€ë‹¤"],
            [13, 'ì—°ê´€ì–´', 'acceleration', "n.ê°€ì†, ì´‰ì§„"],
            [15, 'í‘œì œì–´', 'accessory', "n.ë¶€ì†ë¬¼"],
            [15, 'ì—°ê´€ì–´', 'access', "v.ì ‘ê·¼í•˜ë‹¤ n.ì ‘ê·¼"],
            [40, 'í‘œì œì–´', 'accommodate', "v.ìˆ˜ìš©í•˜ë‹¤, í¸ì˜ë¥¼ ë„ëª¨í•˜ë‹¤"],
            [40, 'ì—°ê´€ì–´', 'accommodation', "n.ìˆ™ì†Œ, ìˆ˜ìš© ì‹œì„¤"],
            [11, 'í‘œì œì–´', 'accord', "v.ë¶€í•©í•˜ë‹¤, ì¼ì¹˜í•˜ë‹¤ n.ì¼ì¹˜, í•©ì˜"],
            [11, 'ì—°ê´€ì–´', 'accordingly', "ad.ê·¸ì— ë”°ë¼ì„œ"],
            [12, 'í‘œì œì–´', 'account', "v.ì„¤ëª…í•˜ë‹¤, (ë¹„ìœ¨ì„) ì°¨ì§€í•˜ë‹¤ n.ê³„ì¢Œ, ì„¤ëª…, ê¸°ì‚¬"],
            [12, 'ì—°ê´€ì–´', 'accountable', "a.ì±…ì„ì´ ìˆëŠ”"],
            [4, 'í‘œì œì–´', 'acknowledge', "v.ì¸ì •í•˜ë‹¤, ìŠ¹ì¸í•˜ë‹¤"],
            [4, 'ì—°ê´€ì–´', 'acknowledgement', "n.ì¸ì •, ìŠ¹ì¸, ê°ì‚¬"],
            [10, 'í‘œì œì–´', 'acquire', "v.ìŠµë“í•˜ë‹¤, ì–»ë‹¤"],
            [10, 'ì—°ê´€ì–´', 'acquisition', "n.ìŠµë“, ì·¨ë“"],
            [11, 'í‘œì œì–´', 'addict', "v.ì¤‘ë…ì‹œí‚¤ë‹¤ n.ì¤‘ë…ì"],
            [11, 'ì—°ê´€ì–´', 'addiction', "n.ì¤‘ë…"],
            [23, 'í‘œì œì–´', 'adequate', "a.ì¶©ë¶„í•œ"],
            [23, 'ì—°ê´€ì–´', 'adequately', "ad.ì¶©ë¶„íˆ"],
            [24, 'í‘œì œì–´', 'adolescent', "n.ì²­ì†Œë…„, ì²­ë…„ a.ì²­ì†Œë…„ì˜"],
            [24, 'ì—°ê´€ì–´', 'adolescence', "n.ì²­ì†Œë…„ê¸°"],
            [10, 'í‘œì œì–´', 'adopt', "v.ì…ì–‘í•˜ë‹¤, ì±„íƒí•˜ë‹¤"],
            [10, 'ì—°ê´€ì–´', 'adoption', "n.ì…ì–‘, ì±„íƒ"],
            [17, 'í‘œì œì–´', 'advance', "v.ì „ì§„í•˜ë‹¤, ì§„ë³´í•˜ë‹¤ n.ì „ì§„, ì§„ë³´"],
            [17, 'ì—°ê´€ì–´', 'advanced', "a.ì„ ì§„ì˜, ê³ ê¸‰ì˜"],
            [23, 'í‘œì œì–´', 'adventure', "n.ëª¨í—˜"],
            [23, 'ì—°ê´€ì–´', 'adventurous', "a.ëª¨í—˜ì ì¸"],
            [24, 'í‘œì œì–´', 'advertise', "v.ê´‘ê³ í•˜ë‹¤, í™ë³´í•˜ë‹¤"],
            [24, 'ì—°ê´€ì–´', 'advertisement', "n.ê´‘ê³ "],
            [31, 'í‘œì œì–´', 'advocate', "v.ì§€ì§€í•˜ë‹¤, ì˜¹í˜¸í•˜ë‹¤ n.ì§€ì§€ì, ì˜¹í˜¸ì"],
            [31, 'ì—°ê´€ì–´', 'advocacy', "n.ì§€ì§€, ì˜¹í˜¸"],
            [32, 'í‘œì œì–´', 'affiliate', "v.ê°€ì…ì‹œí‚¤ë‹¤, ì œíœ´í•˜ë‹¤ n.ê³„ì—´ì‚¬"],
            [32, 'ì—°ê´€ì–´', 'affiliation', "n.ê°€ì…, ì œíœ´"],
            [33, 'í‘œì œì–´', 'afford', "v.ê°ë‹¹í•˜ë‹¤, ì—¬ìœ ê°€ ë˜ë‹¤"],
            [33, 'ì—°ê´€ì–´', 'affordable', "a.ê°ë‹¹í•  ìˆ˜ ìˆëŠ”"],
            [36, 'í‘œì œì–´', 'agency', "n.ëŒ€ë¦¬ì , ê¸°ê´€"],
            [36, 'ì—°ê´€ì–´', 'agent', "n.ëŒ€ë¦¬ì¸, ì¤‘ê°œì¸"],
            [37, 'í‘œì œì–´', 'agony', "n.ê³ í†µ, ê³ ë‡Œ"],
            [37, 'ì—°ê´€ì–´', 'agonize', "v.ê³ ë‡Œí•˜ë‹¤"],
            [38, 'í‘œì œì–´', 'aid', "v.ë•ë‹¤, ì›ì¡°í•˜ë‹¤ n.ë„ì›€, ì›ì¡°"],
            [31, 'í‘œì œì–´', 'aircraft', "n.í•­ê³µê¸°, ë¹„í–‰ê¸°"],
            [31, 'ì—°ê´€ì–´', 'airplane', "n.ë¹„í–‰ê¸°"],
            [38, 'ì—°ê´€ì–´', 'aide', "n.ë³´ì¢Œê´€"],
            [39, 'í‘œì œì–´', 'aim', "v.ëª©í‘œë¡œ í•˜ë‹¤, ê²¨ëƒ¥í•˜ë‹¤ n.ëª©í‘œ, ëª©ì "],
            [39, 'ì—°ê´€ì–´', 'aimless', "a.ëª©í‘œ ì—†ëŠ”"],
            [39, 'í‘œì œì–´', 'aisle', "n.í†µë¡œ (ê·¹ì¥ì˜ ë³µë„, ê¸°ë‚´ í†µë¡œ ë“±)"],
            [39, 'ì—°ê´€ì–´', 'island', "n.ì„¬"],
            [40, 'í‘œì œì–´', 'albeit', "ë¹„ë¡ ~ì¼ì§€ë¼ë„"],
            [40, 'ì—°ê´€ì–´', 'although', "ë¹„ë¡ ~ì¼ì§€ë¼ë„"],
            [1, 'í‘œì œì–´', 'allocate', "v.í• ë‹¹í•˜ë‹¤, ë°°ë¶„í•˜ë‹¤"],
            [1, 'ì—°ê´€ì–´', 'allocation', "n.í• ë‹¹, ë°°ë¶„"],
            [1, 'í‘œì œì–´', 'altogether', "ad.ì „ì ìœ¼ë¡œ, ëª¨ë‘ í•©í•´ì„œ"],
            [1, 'ì—°ê´€ì–´', 'all together', "ë‹¤ í•¨ê»˜"],
            [3, 'í‘œì œì–´', 'amateur', "n.ì•„ë§ˆì¶”ì–´, ë¹„ì „ë¬¸ê°€"],
            [3, 'ì—°ê´€ì–´', 'professional', "n.ì „ë¬¸ê°€"],
            [41, 'í‘œì œì–´', 'ambition', "n.ì•¼ë§, í¬ë¶€"],
            [41, 'ì—°ê´€ì–´', 'ambitious', "a.ì•¼ë§ ìˆëŠ”"],
            [41, 'í‘œì œì–´', 'amusement', "n.ì¬ë¯¸, ì˜¤ë½"],
            [41, 'ì—°ê´€ì–´', 'amuse', "v.ì¦ê²ê²Œ í•˜ë‹¤"],
            [42, 'í‘œì œì–´', 'ancestor', "n.ì¡°ìƒ, ì„ ì¡°"],
            [42, 'ì—°ê´€ì–´', 'descendant', "n.í›„ì†, ìì†"],
            [42, 'í‘œì œì–´', 'annoy', "v.ì§œì¦ë‚˜ê²Œ í•˜ë‹¤"],
            [42, 'ì—°ê´€ì–´', 'annoyance', "n.ì§œì¦, ì„±ê°€ì‹¬"],
            [42, 'í‘œì œì–´', 'anticipate', "v.ì˜ˆìƒí•˜ë‹¤, ê¸°ëŒ€í•˜ë‹¤"],
            [42, 'ì—°ê´€ì–´', 'anticipation', "n.ì˜ˆìƒ, ê¸°ëŒ€"],
            [44, 'í‘œì œì–´', 'appeal', "v.í˜¸ì†Œí•˜ë‹¤, í•­ì†Œí•˜ë‹¤ n.ë§¤ë ¥, í˜¸ì†Œ"],
            [44, 'ì—°ê´€ì–´', 'appealing', "a.ë§¤ë ¥ì ì¸, í˜¸ì†Œí•˜ëŠ”"],
            [44, 'í‘œì œì–´', 'applaud', "v.ë°•ìˆ˜ ì¹˜ë‹¤, ì¹­ì°¬í•˜ë‹¤"],
            [44, 'ì—°ê´€ì–´', 'applause', "n.ë°•ìˆ˜, ì¹­ì°¬"],
            [45, 'í‘œì œì–´', 'appoint', "v.ì„ëª…í•˜ë‹¤, ì •í•˜ë‹¤"],
            [45, 'ì—°ê´€ì–´', 'appointment', "n.ì•½ì†, ì„ëª…"],
            [45, 'í‘œì œì–´', 'appreciate', "v.ê°ì‚¬í•˜ë‹¤, ì§„ê°€ë¥¼ ì¸ì •í•˜ë‹¤"],
            [45, 'ì—°ê´€ì–´', 'appreciation', "n.ê°ì‚¬, ì¸ì •"],
            [46, 'í‘œì œì–´', 'appropriate', "a.ì ì ˆí•œ, ì í•©í•œ"],
            [46, 'ì—°ê´€ì–´', 'appropriately', "ad.ì ì ˆí•˜ê²Œ"],
            [46, 'í‘œì œì–´', 'arbitrary', "a.ì„ì˜ì ì¸, ë…ë‹¨ì ì¸"],
            [46, 'ì—°ê´€ì–´', 'arbitrarily', "ad.ì„ì˜ë¡œ, ë…ë‹¨ì ìœ¼ë¡œ"],
            [47, 'í‘œì œì–´', 'archive', "n.ê¸°ë¡ ë³´ê´€ì†Œ, ê¸°ë¡"],
            [47, 'ì—°ê´€ì–´', 'archived', "a.ê¸°ë¡ ë³´ê´€ëœ"],
            [47, 'í‘œì œì–´', 'arise', "v.ë°œìƒí•˜ë‹¤, ìƒê²¨ë‚˜ë‹¤"],
            [47, 'ì—°ê´€ì–´', 'arose', "v.ë°œìƒí–ˆë‹¤ (ê³¼ê±°í˜•)"],
            [48, 'í‘œì œì–´', 'arrogant', "a.ì˜¤ë§Œí•œ, ê±°ë§Œí•œ"],
            [48, 'ì—°ê´€ì–´', 'arrogance', "n.ì˜¤ë§Œ, ê±°ë§Œ"],
            [48, 'í‘œì œì–´', 'artificial', "a.ì¸ê³µì ì¸, ê°€ì§œì˜"],
            [48, 'ì—°ê´€ì–´', 'artificially', "ad.ì¸ìœ„ì ìœ¼ë¡œ"],
            [49, 'í‘œì œì–´', 'assault', "v.í­í–‰í•˜ë‹¤, ê³µê²©í•˜ë‹¤ n.í­í–‰, ê³µê²©"],
            [49, 'ì—°ê´€ì–´', 'attacker', "n.ê³µê²©ì"],
            [49, 'í‘œì œì–´', 'assert', "v.ì£¼ì¥í•˜ë‹¤, ë‹¨ì–¸í•˜ë‹¤"],
            [49, 'ì—°ê´€ì–´', 'assertion', "n.ì£¼ì¥, ë‹¨ì–¸"],
            [50, 'í‘œì œì–´', 'assess', "v.í‰ê°€í•˜ë‹¤, ì‚¬ì •í•˜ë‹¤"],
            [50, 'ì—°ê´€ì–´', 'assessment', "n.í‰ê°€, ì‚¬ì •"],
            [50, 'í‘œì œì–´', 'assume', "v.ê°€ì •í•˜ë‹¤, ì¶”ì •í•˜ë‹¤"],
            [50, 'ì—°ê´€ì–´', 'assumption', "n.ê°€ì •, ì¶”ì •"]
            // ì‹¤ì œë¡œëŠ” ì—¬ê¸°ì— ì±•í„° 1ë¶€í„° 50ê¹Œì§€ì˜ ëª¨ë“  ë‹¨ì–´ê°€ í¬í•¨ë©ë‹ˆë‹¤.
            // ... (ë°ì´í„°ì˜ ì–‘ì´ ë„ˆë¬´ ë§ì•„ ì¼ë¶€ë§Œ í‘œì‹œë©ë‹ˆë‹¤)
        ];
        
        // 2. DOM ìš”ì†Œ ì°¸ì¡°
        const settingsView = document.getElementById('settings-view');
        const printView = document.getElementById('print-view');
        const chapterGrid = document.getElementById('chapter-grid');
        const questionCountInput = document.getElementById('question-count');
        const wordTypeSelect = document.getElementById('word-type');
        const testDirectionSelect = document.getElementById('test-direction');
        const generateBtn = document.getElementById('generate-btn');
        const printSheetBtn = document.getElementById('print-sheet-btn');
        const backToSettingsBtn = document.getElementById('back-to-settings');
        const testSheetContainer = document.getElementById('test-sheet-container');
        const answerSheetContainer = document.getElementById('answer-sheet-container');
        const errorMessageDiv = document.getElementById('error-message');

        // 3. ë‹¨ì–´ ë°ì´í„° ì •ì œ ë° ì±•í„° ëª©ë¡ ìƒì„±
        const vocabulary = rawCSVData.map(row => {
            const meaning = row[3];
            const cleanMeaning = meaning
                .replace(/(\s*v\.|n\.|a\.|ad\.)\s*/g, '')
                .replace(/[\"']/g, '')
                .replace(/\s*\(.*\)/g, '')
                .split(',')
                .map(s => s.trim())
                .join(', ');
            
            return {
                chapter: row[0],
                type: row[1],
                word: row[2].trim(),
                meaning: cleanMeaning.trim()
            };
        });

        // 4. ì±•í„° ëª©ë¡ ìƒì„±
        function generateChapterCheckboxes() {
            const allChapters = [...new Set(vocabulary.map(item => item.chapter))].sort((a, b) => a - b);
            
            allChapters.forEach(chapter => {
                const chapterId = `ch-${chapter}`;
                const label = document.createElement('label');
                label.className = 'inline-flex items-center';
                label.innerHTML = `
                    <input type="checkbox" id="${chapterId}" value="${chapter}" class="form-checkbox h-4 w-4 text-indigo-600 rounded">
                    <span class="ml-1 text-sm">${chapter}</span>
                `;
                chapterGrid.appendChild(label);
            });
        }

        // 5. ë°°ì—´ì„ ëœë¤í•˜ê²Œ ì„ëŠ” í•¨ìˆ˜
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // 6. í…ŒìŠ¤íŠ¸ì§€/ì •ë‹µì§€ ìƒì„± í•¨ìˆ˜
        function generateSheets() {
            errorMessageDiv.classList.add('hidden');
            
            // 1. ì„¤ì • ê°’ ê°€ì ¸ì˜¤ê¸°
            const selectedChapters = Array.from(chapterGrid.querySelectorAll('input:checked')).map(cb => parseInt(cb.value));
            const requestedCount = parseInt(questionCountInput.value);
            const wordType = wordTypeSelect.value;
            const direction = testDirectionSelect.value;
            
            if (selectedChapters.length === 0) {
                errorMessageDiv.textContent = 'ì ì–´ë„ í•˜ë‚˜ì˜ Chapterë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.';
                errorMessageDiv.classList.remove('hidden');
                return;
            }
            
            if (requestedCount < 1) {
                errorMessageDiv.textContent = 'ë¬¸í•­ ìˆ˜ëŠ” 1ê°œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.';
                errorMessageDiv.classList.remove('hidden');
                return;
            }

            // 2. í•„í„°ë§
            let filteredWords = vocabulary.filter(word => {
                const chapterMatch = selectedChapters.includes(word.chapter);
                const typeMatch = wordType === 'all' ? true : (word.type === 'í‘œì œì–´');
                return chapterMatch && typeMatch;
            });
            
            if (filteredWords.length === 0) {
                errorMessageDiv.textContent = 'ì„ íƒí•œ ì¡°ê±´ì— ë§ëŠ” ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤. Chapterë‚˜ ìœ í˜•ì„ ë³€ê²½í•´ ì£¼ì„¸ìš”.';
                errorMessageDiv.classList.remove('hidden');
                return;
            }

            // 3. ëœë¤ ì¶”ì¶œ ë° ì„ê¸°
            const shuffledWords = shuffleArray(filteredWords);
            const wordsToTest = shuffledWords.slice(0, requestedCount);
            const finalCount = wordsToTest.length;

            if (finalCount < requestedCount) {
                errorMessageDiv.textContent = `ìš”ì²­í•œ ë¬¸í•­ ìˆ˜(${requestedCount}ê°œ)ë¥¼ ëª¨ë‘ ì±„ìš¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ${finalCount}ê°œì˜ ë¬¸í•­ë§Œ ìƒì„±ë©ë‹ˆë‹¤.`;
                errorMessageDiv.classList.remove('hidden');
            }

            // 4. í…ŒìŠ¤íŠ¸ì§€ ë° ì •ë‹µì§€ ë‚´ìš© ìƒì„±
            let testSheetHTML = `<div class="p-4">
                <div class="sheet-header">
                    <h2 class="text-xl font-bold mb-1">ë‹¨ì–´ í…ŒìŠ¤íŠ¸ì§€</h2>
                    <p class="text-sm">
                        Chapter: ${selectedChapters.join(', ')} | 
                        ìœ í˜•: ${wordType === 'all' ? 'ì „ì²´' : 'í‘œì œì–´'} | 
                        ë°©í–¥: ${direction === 'en_to_ko' ? 'ì˜ì–´â†’í•œê¸€' : 'í•œê¸€â†’ì˜ì–´'} |
                        ë¬¸í•­ ìˆ˜: ${finalCount}
                    </p>
                </div>
                <div class="test-body grid grid-cols-2 gap-x-10">
            `;
            
            let answerSheetHTML = `<div class="p-4">
                <div class="sheet-header">
                    <h2 class="text-xl font-bold mb-1 text-red-600">ì •ë‹µì§€ (Answer Key)</h2>
                    <p class="text-sm">
                        Chapter: ${selectedChapters.join(', ')} | 
                        ìœ í˜•: ${wordType === 'all' ? 'ì „ì²´' : 'í‘œì œì–´'} | 
                        ë¬¸í•­ ìˆ˜: ${finalCount}
                    </p>
                </div>
                <div class="answer-body grid grid-cols-2 gap-x-10">
            `;

            wordsToTest.forEach((item, index) => {
                const prompt = direction === 'en_to_ko' ? item.word : item.meaning;
                const answer = direction === 'en_to_ko' ? item.meaning : item.word;
                const questionNumber = index + 1;

                // í…ŒìŠ¤íŠ¸ì§€ í•­ëª©
                testSheetHTML += `
                    <div class="word-item">
                        <span class="word-item-index">${questionNumber}.</span>
                        <span class="word-item-prompt">${prompt}</span>
                        <span class="word-item-answer"></span>
                    </div>
                `;

                // ì •ë‹µì§€ í•­ëª©
                answerSheetHTML += `
                    <div class="word-item">
                        <span class="word-item-index text-red-600">${questionNumber}.</span>
                        <span class="word-item-prompt">${prompt}</span>
                        <span class="word-item-answer text-red-700 font-medium">${answer}</span>
                    </div>
                `;
            });

            testSheetHTML += `</div></div>`;
            answerSheetHTML += `</div></div>`;

            // 5. í™”ë©´ ì „í™˜ ë° ë‚´ìš© í‘œì‹œ
            testSheetContainer.innerHTML = testSheetHTML;
            answerSheetContainer.innerHTML = answerSheetHTML;

            settingsView.style.display = 'none';
            printView.style.display = 'block';
        }

        // 7. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        generateBtn.addEventListener('click', generateSheets);
        
        printSheetBtn.addEventListener('click', () => {
            window.print();
        });

        backToSettingsBtn.addEventListener('click', () => {
            printView.style.display = 'none';
            settingsView.style.display = 'block';
        });

        // ì´ˆê¸°í™”
        window.onload = generateChapterCheckboxes;
    </script>
</body>
</html>